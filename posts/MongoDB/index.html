<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="content-language" content="en" />
    <link rel="icon" href="/favicon.ico" />
    <title>MongoDB</title>
    <meta name="og:title" content="MongoDB" />
    <meta name="author" content="Gao" />
    <meta name="keywords" content="Document-oriented Database,MongoDB" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="next-head-count" content="10" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
      integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"
      integrity="sha384-ZPe7yZ91iWxYumsBEOn7ieg8q/o+qh/hQpSaPow8T6BwALcXSCS6C6fSRPIAnTQs"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css"
      integrity="sha512-hasIneQUHlh06VNBe7f6ZcHmeRTLIaQWFd43YriJ0UND19bvYRauxthDg8E4eVNPm9bRUhr5JGeqH7FRFXQu5g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="preload"
      href="/_next/static/css/02f4e97d1c9ded28.css"
      as="style"
    />
    <link
      rel="stylesheet"
      href="/_next/static/css/02f4e97d1c9ded28.css"
      data-n-g=""
    />
    <noscript data-n-css=""></noscript>
    <script
      defer=""
      nomodule=""
      src="/_next/static/chunks/polyfills-42372ed130431b0a.js"
    ></script>
    <script src="/_next/static/chunks/webpack.js" defer=""></script>
    <script src="/_next/static/chunks/framework.js" defer=""></script>
    <script src="/_next/static/chunks/main.js" defer=""></script>
    <script src="/_next/static/chunks/pages/_app.js" defer=""></script>
    <script src="/_next/static/chunks/470.js" defer=""></script>
    <script src="/_next/static/chunks/287.js" defer=""></script>
    <script
      src="/_next/static/chunks/pages/posts/%5Bslug%5D.js"
      defer=""
    ></script>
    <script src="/_next/static/fixed/_buildManifest.js" defer=""></script>
    <script src="/_next/static/fixed/_ssgManifest.js" defer=""></script>
  </head>
  <body>
    <div id="__next">
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous"
      />
      <nav
        class="navbar navbar-expand-md navbar-light sticky-top NavigationBar_navBar__fSiIq tw-bg-white/95 tw-shadow tw-shadow-black/25"
      >
        <div class="container-fluid px-md-5">
          <div class="navbar-brand animate__animated animate__pulse">
            <span
              class="tw-rounded tw-bg-black tw-p-1 tw-text-xl tw-font-medium tw-text-white"
              >Gao&#x27;s blog</span
            >
          </div>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mb-2 mb-lg-0 ms-auto">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  aria-current="page"
                  href="/posts/langs/en/pagination/1/"
                  >Home</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  aria-current="page"
                  href="/posts/langs/en/tags/"
                  >Tags</a
                >
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  >Language</a
                >
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a class="dropdown-item" href="/posts/langs/en/">English</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/posts/langs/es/">Spanish</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/posts/langs/zh/">Chinese</a>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <header
        class="tw-flex tw-h-96 tw-w-screen tw-flex-col tw-content-center tw-justify-center tw-bg-cover tw-bg-center tw-bg-no-repeat tw-text-center tw-text-white"
        style="
          background-image: url(/_next/static/media/default-post-preview.c96b099a.jpeg);
        "
      >
        <h1>MongoDB</h1>
        <p>Author: Gao</p>
        <span
          ><i class="fa-regular fa-calendar"></i
          ><time class="tw-pl-1.5" datetime="2020-06-07 13:57:06"
            >June 7, 2020</time
          ></span
        >
        <section class="tw-mt-3 tw-text-center">
          <p>Tags<!-- -->:</p>
          <ul class="tw-p-0">
            <li class="tw-inline tw-px-1">
              <a
                class="tw-m-0.5 tw-inline-block tw-rounded tw-border tw-border-solid tw-border-white tw-bg-neutral-300 tw-px-2 tw-text-sm tw-leading-6 tw-text-white tw-no-underline hover:tw-bg-sky-300"
                href="/posts/langs/en/tags/Document-oriented%20Database/"
                >Document-oriented Database</a
              >
            </li>
            <li class="tw-inline tw-px-1">
              <a
                class="tw-m-0.5 tw-inline-block tw-rounded tw-border tw-border-solid tw-border-white tw-bg-neutral-300 tw-px-2 tw-text-sm tw-leading-6 tw-text-white tw-no-underline hover:tw-bg-sky-300"
                href="/posts/langs/en/tags/MongoDB/"
                >MongoDB</a
              >
            </li>
          </ul>
        </section>
      </header>
      <div class="tw-mx-auto tw-w-11/12">
        <main>
          <article>
            <iframe
              title="MongoDB"
              src="/MongoDB/index.html"
              width="100%"
              height="0px"
            ></iframe>
          </article>
        </main>
        <aside></aside>
      </div>
      <footer class="tw-text-center tw-text-gray-400">
        <div class="row justify-content-center">
          <ul class="list-inline text-center tw-text-stone-700">
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://www.linkedin.com/in/shuxig"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i
                    class="fab fa-linkedin-in fa-stack-1x fa-inverse"
                  ></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="mailto:dalao1002@gmail.com?subject=From my blog&amp;body=Hi,I found this website very useful"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://github.com/vitaminac"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i class="fab fa-github fa-stack-1x fa-inverse"></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://gist.github.com/vitaminac"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i
                    class="fab fa-github-square fa-stack-1x fa-inverse"
                  ></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://gitlab.com/vitaminac"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i class="fab fa-gitlab fa-stack-1x fa-inverse"></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://www.kaggle.com/dalao1002"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i class="fab fa-kaggle fa-stack-1x fa-inverse"></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://leetcode.com/dalao1002"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i class="fas fa-code fa-stack-1x fa-inverse"></i></span
              ></a>
            </li>
            <li class="list-inline-item">
              <a
                class="tw-text-stone-700"
                target="_blank"
                href="https://stackoverflow.com/users/9980245"
                ><span class="fa-stack fa-lg"
                  ><i class="fa fa-circle fa-stack-2x"></i
                  ><i
                    class="fab fa-stack-overflow fa-stack-1x fa-inverse"
                  ></i></span
              ></a>
            </li>
          </ul>
        </div>
        <img
          alt="QR"
          loading="lazy"
          width="1710"
          height="624"
          decoding="async"
          data-nimg="1"
          class="tw-mx-auto tw-max-w-full tw-object-contain tw-object-center lg:tw-max-w-xl"
          style="
            color: transparent;
            background-size: cover;
            background-position: 50% 50%;
            background-repeat: no-repeat;
            background-image: url(&quot;data:image/svg+xml;charset=utf-8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 320 120&#x27;%3E%3Cfilter id=&#x27;b&#x27; color-interpolation-filters=&#x27;sRGB&#x27;%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3CfeColorMatrix values=&#x27;1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1&#x27; result=&#x27;s&#x27;/%3E%3CfeFlood x=&#x27;0&#x27; y=&#x27;0&#x27; width=&#x27;100%25&#x27; height=&#x27;100%25&#x27;/%3E%3CfeComposite operator=&#x27;out&#x27; in=&#x27;s&#x27;/%3E%3CfeComposite in2=&#x27;SourceGraphic&#x27;/%3E%3CfeGaussianBlur stdDeviation=&#x27;20&#x27;/%3E%3C/filter%3E%3Cimage width=&#x27;100%25&#x27; height=&#x27;100%25&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; preserveAspectRatio=&#x27;none&#x27; style=&#x27;filter: url(%23b);&#x27; href=&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAADCAIAAAAhqtkfAAAAVklEQVR42gFLALT/AKrStMHRxZXRpW3NilHIekDGcw/CYyjCZwC/z8LTwcan0LKu37rI48+228C838WZ16oApdSxvdPCi86doNmvx+LNu9vDx+LOn9muCIkyTVum2sgAAAAASUVORK5CYII=&#x27;/%3E%3C/svg%3E&quot;);
          "
          src="/_next/static/media/QR.b48259ea.png"
        />
        <p>Copyright © Gao&#x27;s blog 2024</p>
      </footer>
    </div>
    <script id="__NEXT_DATA__" type="application/json">
      {
        "props": {
          "pageProps": {
            "postData": {
              "title": "MongoDB",
              "lang": "en",
              "markdownContentSource": "\n## Scalability\n\nNoSQL is intented to offer more scalability. A balance between the scalability and the consistency.\n\n### Vertical\n\nFunctional decomposition\n\n### Horizontal\n\nScale by cloing\n\n### Transversal\n\nPartitioning similar things\n\n### Google Evulution\n\n#### Google File System\n\nDistributed file system to provide efficient, **reliable access** to data using large clusters of commodity hardward.\n\n#### MapReduce\n\nIt is a parallel, distributed algorithm on a cluster.\n\n![Map Reduce](map-reduce.png)\n\n#### Percolator\n\nThe process of updating an index is now divided into multiple concurrent transactions, each of which has to preserve invariants.\n\n![Percolator](percolator.png)\n\n#### Pregel\n\nIt is system for large scale graph processing.\n\n#### Dremel\n\nDremel is a distributed system developed for interactively quering large datasets.\n\n## DHT\n\nWe use hash function to select node of the cluster, acts as a routing function\n\n## CAP Theorem\n\nThe CAP theorem, also named Brewer's theorem states that it is impossible for a distributed data store to simultaneously provide more than two out of the following three guarantees:\n\n* Consistency: Every read receives the most recent write or an error\n* Availability: Every request receives a non-error response, without the guarantee that it contains the most recent write\n* Partition tolerante: The system continues to operate despite an arbitrary number of messages being dropped.\n\n## PACELC\n\n* P = Partition\n    * A: DynamoDB, Cassandra, Cosmos DB\n    * C: BigTable/HBase, MongoDB, MySQL Cluster\n* E = Else\n    * L: DynamoDB, Cassandra, Cosmos DB\n    * C: BigTable/HBase, MongoDB, MySQL Cluster\n\n## Consensus algorithm\n\nIt is used to achieve aggrement on a single data value among distributed processes or systems or the current state of distributed system. It is used to achieve reliability in a network involving multiple distributed nodes that contain the same information. A tipical use is to select the leader.\n\n1. Even if a single value is proposed, the network eventually recognizes it and choose it.\n2. Once the value is chosen by the network, it cannot be overwritten.\n3. Nodes don’t hear that a value has been chosen, unless it has really been chosen by the network.\n\n### Paxos\n\nThere are two main components Proposers(P) and Acceptors(A). There is also a listener(L), but it is less interesting for the majority of the discussion. Each nodes acts as all three. Proposers propose values based on client requests. Acceptors accept values and when there is majority/quorum, the proposed value is chosen and committed to the log. There could be a lot of of back and forth between P and A before the value gets chosen.\n\n## ACID\n\nThe relational database conforms with ACID principles.\n\n* Atomic: Each transaction is treated as a single unit\n* Consistency: A transaction can only bring the database from one valid state to another\n* Isolation: Concurrent execution of transactions leaves the database in the same state that would have been obtained if the transactions were executed sequentially.\n* Durability: once a transaction has been committed, it will remain committed even in the case of a system failure\n\n## BASE\n\nMany NoSQL database conforms with BASE principles.\n\n* Basic Availability: The system does guarantee availability\n* Soft-state: State of the system may change over time, even without input.\n* Eventually consistent: The system will become consistent over time, given that the system doesn't receive input during that time.\n    * Anti-Entropy Protocol: interchange update between nodes\n    * Reconciliation: All the replica arrive at a stable state.\n    * Liveness\n\n## NoSQL\n\nNoSQL stands for Not Only SQL which provide simple, and flexible and usually schemaless structure. It does not provide the consistency such as we provide with SGBDR.\n\n* Schemaless\n* Distributed\n* Structured Data\n* Avoid Join (it allows scale horizontally)\n\n### Graph database\n\nGraph databases are purpose-built to store and navigate relationships. Relationships are first-class citizens in graph databases, and most of the value of graph databases is derived from these relationships. Graph databases use nodes to store data entities, and edges to store relationships between entities. An edge always has a start node, end node, type, and direction, and an edge can describe parent-child relationships, actions, ownership, and the like. There is no limit to the number and kind of relationships a node can have.\n\n* Amazon Neptune\n* Neo4j\n\n### Key-Value\n\nA key-value database is a type of nonrelational database that uses a simple key-value method to store data. A key-value database stores data as a collection of key-value pairs in which a key serves as a unique identifier. Both keys and values can be anything, ranging from simple objects to complex compound objects. Key-value databases are highly partitionable and allow horizontal scaling at scales that other types of databases cannot achieve. The document model works well with use cases such as catalogs, user profiles, and content management systems where each document is unique and evolves over time. Document databases enable flexible indexing, powerful ad hoc queries, and analytics over collections of documents.\n\n* Amazon DynamoDB\n* Redis\n\n### Semantic\n\n* Triplestores\n\n### Columnar Database\n\nA columnar database is optimized for fast retrieval of columns of data, typically in analytical applications. Column-oriented databases are designed to scale “out” using distributed clusters of low-cost hardware to increase throughput.\n\n* Amazon Redshift\n* Apache Cassandra\n* Apache HBase\n\n### Search-Engine Database\n\nA search-engine database is a type of nonrelational database that is dedicated to the search of data content. Search-engine databases use indexes to categorize the similar characteristics among data and facilitate search capability. Search-engine databases are optimized for dealing with data that may be long, semistructured, or unstructured, and they typically offer specialized methods such as full-text search, complex search expressions, and ranking of search results. \n\n* Elastic Search\n\n### Document-oriented Database\n\nA document database is a type of nonrelational database that is designed to store and query data as JSON-like documents. Document databases make it easier for developers to store and query data in a database by using the same document-model format they use in their application code. The flexible, semistructured, and hierarchical nature of documents and document databases allows them to evolve with applications’ needs.\n\n* MongoDB\n* Amazon DocumentDB\n\nA simple description is key-value database where the value is document, e.g. **JSON** or **XML**.\n\n    {\n    field1: value1,\n    field2: value2,\n    field3: value3,\n    ...\n    fieldN: valueN\n    }\n\n* It is **schemaless** which means more **flexibility** to deal with complex data. \n* we can have **embedded document**.\n* we want to **avoid** using **join**.\n* The difference with key-value is we are allowed to recover document with document's **attributes**.\n* Documents combine structure and content, and there is great freedom in their structure. \n* We can simulate relationship using key of other document.\n* Documents are grouped into **collections**.\n  * We should only store documents of same type in a collection.\n  * If we liked store two types into one collection there must have a type identifier. Query one type of documents may require more time.\n  * CRUD must be common for all document inside the colelction\n* Documents are **polymorphic**, which means they don't have to maintain the same data structure.\n* We may find the **inconsistency** of the referenced document in other document.\n\n### Design Decision\n\n* **Balance** between redundancy and performance, **normalizatión y denormalization**.\n    * **Normalization** reduce the anomalies\n    * **Denormalization** Improve the performance.\n* Priority for **flexibility** and **scalability**\n* Be careful with document size, maximum 16MB\n* identify the indices\n  * index can improve the performance of read\n  * index also reduce the performance of write\n  * read heavy or write heavy\n* Think of **frequent queries**.\n    * If we have three products and all queries use all three products then we should put them into the **same collection**.\n    * Another situation we use same collecon is we know we will have more more types of product.\n* Is it atomic requiered? since we don't support transation across multiple document.\n* Schemaless != No schema, it means flexible\n    * same attribute can contains different data type\n* It suit our developmente because types of queries/applications can change\n\n#### Model Relationships Between Documents\n\n* Embedded Documents\n    * One-to-One\n    * One-to-Few\n    * Fast Retrieval\n    * Denormalization\n    * Two documents must be embedded if your information is always used together.\n* One-to-Many: Embedded Documents\n* Document References\n    * Many to Many\n    * The referential integrity of these documents has to be controlled at the application level\n    * **DBRef**\n* Hierarchy\n    * Store reference to parent document\n    * Store list of children in parent document\n\n## MongoDB\n\nRobust and scalable document oriented NoSQL. **Doesn't support transation** across multiple documents.\n\n* **Schemaless**\n* **Nested Document**\n* **Semi-structured data**\n\n### CRUD\n\n#### Show collections\n\n* Javascript: **db.getCollectionNames()**\n* Console: **show collections**\n\n#### Create\n\n##### Insert\n\n    db.books.insertOne({'title':'Thinking in Java', 'autor':'Bruce Eckel'})\n\n##### Bulk Insert\n\n    db.books.insertMany([{'title':'Thinking in Java', 'autor':'Bruce Eckel'}, {'title':'Effective Java', 'author':'Joshua Bloch'}])\n\nBy default the insertion is **ordered**. If there is a error during the insertiong it will just skip the document and continue with the next.\n\n##### Uniqueness\n\nThe field name **_id** is reserved for use as a primary key; its value must be unique in the collection, is immutable, and may be of any type other than an array, by default an ObjectId is generated. ObjectId is made up of **12 bytes**. The **first four bytes are a timestamp** with the second ones; the next **three bytes** represent the **unique identifier of the machine**; the **next two are the process identifier**; And finally, the **last three bytes** are an **incremental field**. It give us document creation date.                \n\n#### Read\n\n##### Read All\n\n    db.collections.find()\n    db.collections.find().pretty()\n\n##### Filter\n\n    db.books.find({'title':{$eq : 'Thinking in Java'}})\n    db.books.find({$and : [\n        {$or : [{'title':{$regex : '^Thinking'}}, {'title':{$regex : '^Effective'}}]},\n        {'title':{$regex : 'Java$'}}\n    ]})\n\n[Query Selectors](https://docs.mongodb.com/manual/reference/operator/query/)\n\nThe syntax is **{ attribute: { $operador: value } }**\n\n##### Filter with Embedded Document\n\n    db.clients.find({\"direction\": {\"street\":\"C/XX, 99\", \"city\": \"BB\", \"state\":\"SS\", \"ZIP\":\"123456\"}})\n\n##### Filter with Arrays\n\n    db.clients.find({\"tel\":[\"123456789\", \"987654321\"]})\n\n#### Update\n\n    db.books.update({'title':'Thinking in Java'}, {$set: {'ISBN':'978-0131872486'}})\n\n[Update Operators](https://docs.mongodb.com/manual/reference/operator/update/)\n\nthe syntax is **{ $operador: { attribute: value } }**\n\n##### Upsert\n\n If **upsert** set to true, creates a new document when no document matches the query criteria. The default value is false, which does not insert a new document when no match is found.\n\n    db.collection.update(query, update, {upsert: true})\n\n#### Save\n\nUpdates an existing document or inserts a new document, depending on its document parameter.\n\n    db.collection.save(\n        \u003cdocument\u003e,\n        {\n            writeConcern: \u003cdocument\u003e\n        }\n    )\n\n#### Delete\n\n##### Single Item\n\n    db.books.remove([{'author':'Bruce Eckel'}])\n\n##### Delete All Documents Inside The Collection\n\n    db.books.drop()\n\nHas better **drop** performance than **remove**\n\n#### Sort\n\n    db.books.find().sort({'title':1, ...more fields to use for sorting})\n\n* ascending: 1\n* descending: -1\n\n#### Count\n\n    db.books.find().count()\n    db.books.count({\"author\":{$eq:\"ABC\"}})\n\n### Indexes\n\nIndexes in MongoDB are generated as a **B-tree**. This increases the speed when searching and sorting when returning results. It is recommended that these fields have a **high cardinality**.\n\n    db.coleccion.createIndex({…})\n    db.coleccion.dropIndex({…})\n    db.coleccion.dropIndexes()\n    db.coleccion.getIndexes()\n\n#### Single Field\n\n    db.coleccion.createIndex({ a: 1 })\n\n#### Compound Index\n\n    db.coleccion.createIndex({ A: 1, B: -1, C: 1 })\n\nThe index that will be generated with the previous statement will group the data first by the field A ascendingly and then by the field B descendingly and the by the field C ascendingly. Composite indexes can be used to query one or more of the fields. In these case we can query A, or A and B together, or A and B and C together. We can only query together if they match the order.\n\n#### Unique Index\n\nThe unique property for an index causes MongoDB to reject duplicate values for the indexed field.\n\n    db.coleccion.createIndex({'name':1}, {\"unique\":true})\n\n#### Sparse Indexes\n\nThe sparse property of an index ensures that the index only contain entries for documents that have the indexed field.\n\n    db.coleccion.createIndex({'name':1}, {\"sparse\":true})\n\n#### Partial Indexes\n\nPartial indexes only index the documents in a collection that meet a specified filter expression.\n\n    db.coleccion.createIndex({'name':1}, {partialFilterExpression: {age: {$gt:18}}})\n\n#### Index Intersection\n\nMongoDB can use the intersection of multiple indexes to fulfill queries.\n\n    db.coleccion.createIndex({'name':1})\n    db.coleccion.createIndex({'age':1})\n    db.coleccion.find({'name;: \"Jorge\", 'age': {$gt:18}})\n\n#### Index on Embedded Document\n\n    db.coleccion.createIndex({ address.city\" : 1})\n\n#### Multikey Indexes\n\nTo index a field that holds an array value, MongoDB creates an index key for each element in the array. These multikey indexes support efficient queries against array fields. The limitation is only one field can be array type.\n\n    db.coll.createIndex({\u003cfield\u003e: \u003c 1 or -1 \u003e })\n\n#### Covered Query\n\nA covered query is a query that can be satisfied entirely using an index and does not have to examine any documents. An index covers a query when all of the following apply\n\n* all the fields in the query are part of an index\n* all the fields returned in the results are in the same index.\n* no fields in the query are equal to null (i.e. {\"field\" : null} or {\"field\" : {$eq : null}} ).\n\n#### Debug Query\n\n    db.colección.find().explain()\n\n### Aggregation Framework\n\n#### Aggregation Pipeline\n\nAggregation operations process data records and return computed results, it is modeled on the concept of data processing pipelines with [stages operators](https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/) and the [expression operators](https://docs.mongodb.com/manual/reference/operator/aggregation/).\n\n    db.orders.aggregate([\n        {$match: { status: \"A\" }},\n        {$group: { _id: \"$cust_id\", total: { $sum: \"$amount\" }}}\n    ])\n\n{% iframe https://docs.mongodb.com/manual/_images/agg-pipeline.mp4 %}\n\nEach operators receives a set of arguments\n\n    {\u003coperador\u003e:[\u003cargumento1\u003e, \u003cargumento2\u003e...]}\n\nExpressions are used as filters, and usually have no state of their own except the accumulator. But not all the acumudor has the global state e.g. $project.\n\n##### $project\n\nReshapes each document in the stream, such as by adding new fields or removing existing fields.\n\n    { $project: { \u003cspecifications\u003e }}\n\n##### $match\n\nFilters the document stream to allow only matching documents to pass unmodified into the next pipeline stage.\n\n    { $match: { \u003cquery\u003e } }\n\n##### $sample\n\nRandomly selects the specified number of documents from its input.\n\n    {$sample: {size: \u003cpositive integer\u003e}}\n\n##### $sort\n\nReorders the document stream by a specified sort key.\n\n    { $sort: { \u003cfield1\u003e: \u003corder\u003e, \u003cfield2\u003e:\u003corder\u003e ... }}\n\n##### $limit\n\nPasses the first n documents unmodified to the pipeline where n is the specified limit.\n\n    { $limit: \u003cpositive integer\u003e }\n\n##### $skip\n\nSkips the first n documents where n is the specified skip number and passes the remaining documents unmodified to the pipeline.\n\n    { $skip: \u003cpositive integer\u003e }\n\n##### $out\n\nWrites the resulting documents of the aggregation pipeline to a collection.\n\n    { $out: \"\u003coutput collections\u003e\" }\n\n##### $group\n\nGroups input documents by a specified identifier expression and applies the accumulator expression(s), if specified, to each group.\n\n    {\n      $group:\n        {\n          _id: \u003cexpression\u003e, // Group By Expression\n          \u003cfield1\u003e: { \u003caccumulator1\u003e : \u003cexpression1\u003e },\n        ...\n        }\n    }\n\n##### $unwind\n\nDeconstructs an array field from the input documents to output a document for each element. Each output document replaces the array with an element value\n\n    {$unwind: \u003carray field\u003e}\n\n##### $lookup\n\nPerforms a left outer join to another collection in the same database.\n\n    {\n      $lookup:\n        {\n          from: \u003ccollection to join\u003e,\n          localField: \u003cfield from the input documents\u003e,\n          foreignField: \u003cfield from the documents of the \"from\" collection\u003e,\n          as: \u003coutput array field\u003e\n        }\n    }\n\n#### Map-Reduce\n\nMongoDB also provides map-reduce operations to perform aggregation. In general, map-reduce operations have two phases: a map stage that processes each document and emits one or more objects for each input document, and reduce phase that combines the output of the map operation.\n\n![Map-Reduce](https://docs.mongodb.com/manual/_images/map-reduce.bakedsvg.svg)\n\n## Reference\n\n* [MongoDB Getting Started](https://docs.mongodb.com/manual/tutorial/getting-started/)\n* [MongoDB Relationships](https://docs.mongodb.com/manual/applications/data-models-relationships/)\n* [MongoDB Indexes](https://docs.mongodb.com/manual/indexes/)\n* [MongoDB Query Optimization](https://docs.mongodb.com/manual/core/query-optimization/)\n* [MongoDB Aggregation](https://docs.mongodb.com/manual/aggregation/)",
              "slug": "MongoDB",
              "date": "2020-06-07 13:57:06",
              "tags": ["Document-oriented Database", "MongoDB"],
              "path": "/MongoDB/index.html"
            },
            "lang": "en",
            "_nextI18Next": {
              "initialI18nStore": {
                "en": {
                  "navbar": {
                    "Home": "Home",
                    "Language": "Language",
                    "Tags": "Tags",
                    "en": "English",
                    "es": "Spanish",
                    "zh": "Chinese"
                  },
                  "post-layout": {
                    "Author": "Author: {{author}}",
                    "Tags": "Tags"
                  }
                }
              },
              "initialLocale": "en",
              "ns": ["navbar", "post-layout"],
              "userConfig": {
                "i18n": {
                  "defaultLocale": "en",
                  "locales": ["en", "es", "zh"]
                },
                "default": {
                  "i18n": {
                    "defaultLocale": "en",
                    "locales": ["en", "es", "zh"]
                  }
                }
              }
            }
          },
          "__N_SSG": true
        },
        "page": "/posts/[slug]",
        "query": { "slug": "MongoDB" },
        "buildId": "fixed",
        "isFallback": false,
        "gsp": true,
        "scriptLoader": []
      }
    </script>
  </body>
</html>
