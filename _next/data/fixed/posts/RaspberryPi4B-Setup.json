{
  "pageProps": {
    "postData": {
      "slug": "RaspberryPi4B-Setup",
      "tags": [
        "Linux",
        "Debian",
        "Raspberry",
        "Raspberry Pi 4",
        "Prestashop",
        "Workspace Setup"
      ],
      "isDraft": false,
      "isArchived": false,
      "title": "Raspberry Pi 4B Setup",
      "date": "2025-07-30 01:07:15",
      "isLegacy": false,
      "lang": "en",
      "tocHtml": "<ol>\n<li><a href=\"#Buy-a-Raspberry-Pi-4B\">Buy a Raspberry Pi 4B</a>\n<ol>\n<li><a href=\"#Choose-SD-Card\">Choose SD Card</a></li>\n<li><a href=\"#Overclock-SD-Card\">Overclock SD Card</a></li>\n<li><a href=\"#SD-Card-Speed-Test\">SD Card Speed Test</a></li>\n</ol>\n</li>\n<li><a href=\"#Burn-the-Raspberry-Pi-OS-image-to-SD-card\">Burn the Raspberry Pi OS image to SD card</a></li>\n<li><a href=\"#CLI-Enviroment-Configuration\">CLI Enviroment Configuration</a>\n<ol>\n<li><a href=\"#Boot-Raspberry-Pi-OS-Lite\">Boot Raspberry Pi OS Lite</a></li>\n<li><a href=\"#Switch-to-TTY\">Switch to TTY</a></li>\n<li><a href=\"#Set-Language\">Set Language</a></li>\n<li><a href=\"#Set-Keyboard-Layout\">Set Keyboard Layout</a></li>\n<li><a href=\"#Rotate-the-TTY-Screen\">Rotate the TTY Screen</a></li>\n<li><a href=\"#Connect-to-Wi-Fi\">Connect to Wi-Fi</a></li>\n</ol>\n</li>\n<li><a href=\"#Configure-Static-IP-Address\">Configure Static IP Address</a></li>\n<li><a href=\"#Setting-up-SSH-Server\">Setting up SSH Server</a>\n<ol>\n<li><a href=\"#Enable-SSH-Server\">Enable SSH Server</a></li>\n<li><a href=\"#Configure-Passwordless-SSH-Access\">Configure Passwordless SSH Access</a></li>\n<li><a href=\"#Disable-Password-Authentication\">Disable Password Authentication</a></li>\n<li><a href=\"#Change-SSH-Server-Port\">Change SSH Server Port</a></li>\n<li><a href=\"#Disable-IPv6-SSH-Access\">Disable IPv6 SSH Access</a></li>\n<li><a href=\"#Listen-To-Local-Network-Only\">Listen To Local Network Only</a></li>\n<li><a href=\"#Apply-Latest-SSH-Configuration\">Apply Latest SSH Configuration</a></li>\n</ol>\n</li>\n<li><a href=\"#Firewall-Configuration\">Firewall Configuration</a></li>\n<li><a href=\"#Disable-Wi-Fi--Bluetooth\">Disable Wi-Fi &#x26; Bluetooth</a></li>\n<li><a href=\"#Configure-Fan\">Configure Fan</a></li>\n<li><a href=\"#NAS-with-Samba-and-External-Disk-through-USB-30\">NAS with Samba and External Disk through USB 3.0</a>\n<ol>\n<li><a href=\"#Mount-External-Disk\">Mount External Disk</a></li>\n<li><a href=\"#Setup-Shared-Folder-on-Raspberry\">Setup Shared Folder on Raspberry</a></li>\n<li><a href=\"#Mount-Samba-Shared-Folder\">Mount Samba Shared Folder</a></li>\n<li><a href=\"#Remove-Samba-Shared-Folder\">Remove Samba Shared Folder</a></li>\n</ol>\n</li>\n<li><a href=\"#NAS-Backup-with-Dropbox-and-Rclone\">NAS Backup with Dropbox and Rclone</a>\n<ol>\n<li><a href=\"#Get-your-own-Dropbox-App-ID\">Get your own Dropbox App ID</a></li>\n<li><a href=\"#Install-Rclone\">Install Rclone</a></li>\n<li><a href=\"#Configure-Rclone\">Configure Rclone</a></li>\n<li><a href=\"#Backup-with-Dropbox\">Backup with Dropbox</a></li>\n<li><a href=\"#Keep-Dropbox-Synced-With-Local\">Keep Dropbox Synced With Local</a></li>\n<li><a href=\"#Keep-Local-Synced-With-Dropbox\">Keep Local Synced With Dropbox</a></li>\n</ol>\n</li>\n<li><a href=\"#Upgrade-Raspberry-Pi-OS\">Upgrade Raspberry Pi OS</a>\n<ol>\n<li><a href=\"#Remove-Unused-Software-After-Upgrade\">Remove Unused Software After Upgrade</a></li>\n</ol>\n</li>\n<li><a href=\"#Desktop-Environment-Configuration\">Desktop Environment Configuration</a>\n<ol>\n<li><a href=\"#Install-Desktop-Environment-from-Lite-Version\">Install Desktop Environment from Lite Version</a></li>\n<li><a href=\"#Boot-Raspberry-Pi-OS-with-desktop\">Boot Raspberry Pi OS with desktop</a></li>\n<li><a href=\"#Configure-Display-Setting\">Configure Display Setting</a></li>\n<li><a href=\"#Rotate-your-Display-in-GUI\">Rotate your Display in GUI</a></li>\n</ol>\n</li>\n<li><a href=\"#Reference\">Reference</a></li>\n</ol>",
      "articleHtml": "<h2 id=\"Buy-a-Raspberry-Pi-4B\">Buy a Raspberry Pi 4B<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Buy-a-Raspberry-Pi-4B\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>You can buy the Raspberry Pi 4B board on Amazon, the recommended version is 4 GB. You may also need to buy a SD card, and optional case with fan.</p>\n<h3 id=\"Choose-SD-Card\">Choose SD Card<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Choose-SD-Card\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Raspberry Pi has no internal storage, relying instead on a removable micro SD card as his primary boot drives. <a href=\"https://www.reddit.com/r/raspberry_pi/comments/4aoc3r/how_to_overclock_the_microsd_card_reader_on_a/d125ced/\" rel=\"nofollow\" target=\"_blank\">Raspberry Pi 3 doesn&#x27;t support UHS mode because it requires 1.8v signaling while Raspberry Pi 3 is fixed at 3.3v</a>. This is technically the upper bound of write speed (25MB/sec) for <a href=\"https://www.sdcard.org/developers/sd-standard-overview/speed-class/\" rel=\"nofollow\" target=\"_blank\">non-UHS SD cards</a>. Now Raspberry Pi 4B provides a <a href=\"https://datasheets.raspberrypi.org/rpi4/raspberry-pi-4-datasheet.pdf\" rel=\"nofollow\" target=\"_blank\">SD card socket runs on DDR50 bus speed mode</a> and a legacy <a href=\"https://www.sdcard.org/developers/sd-standard-overview/sdio-isdio/\" rel=\"nofollow\" target=\"_blank\">SDIO</a> interface is available on the GPIO pins.</p>\n<p><a href=\"https://www.raspberrypi.org/forums/viewtopic.php?t=271632\" rel=\"nofollow\" target=\"_blank\"><img alt=\"Raspberry Pi 4B\" loading=\"lazy\" width=\"1566\" height=\"1389\" decoding=\"async\" data-nimg=\"1\" style=\"color:transparent\" src=\"/_next/static/media/raspberry-pi-4B-block-diagram.52dad708.png\"/></a></p>\n<p>There is a micro-SD performance improvements with <a href=\"https://www.jeffgeerling.com/blog/2019/raspberry-pi-microsd-card-performance-comparison-2019\" rel=\"nofollow\" target=\"_blank\">Raspberry Pi 4</a>. Raspberry Pi 4 still doesn&#x27;t provide good support for <a href=\"https://www.sdcard.org/developers/sd-standard-overview/application-performance-class/\" rel=\"nofollow\" target=\"_blank\">A2</a> SD card, because A2 cards rely on specialized hardware in the host device to work well. The <a href=\"https://www.pidramble.com/wiki/benchmarks/microsd-cards#4-model-b\" rel=\"nofollow\" target=\"_blank\">benchmark</a> showed that A1 is the best card to use with Rapsberry Pi 4B and got better result than A2.</p>\n<h3 id=\"Overclock-SD-Card\"><a href=\"https://www.jeffgeerling.com/blog/2016/how-overclock-microsd-card-reader-on-raspberry-pi-3\" rel=\"nofollow\" target=\"_blank\">Overclock SD Card</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Overclock-SD-Card\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>DDR50 requires 1.8V signaling, supports frequency up to 50 MHz, sampled on both clock edges and bus speed up to 50 MB/sec per <a href=\"https://www.sdcard.org/downloads/pls/\" rel=\"nofollow\" target=\"_blank\">Physical Layer Simplified Specification</a>. However, <a href=\"https://www.sdcard.org/developers/sd-standard-overview/bus-speed-default-speed-high-speed-uhs-sd-express/\" rel=\"nofollow\" target=\"_blank\">UHS-I</a> SD card <a href=\"https://en.wikipedia.org/wiki/SD_card#UHS-I\" rel=\"nofollow\" target=\"_blank\">supports a clock frequency of 50 MHz (DDR50), 100 MHz (SDR50) and 208MHz (SDR104)</a> per <a href=\"https://www.sdcard.org/downloads/pls/\" rel=\"nofollow\" target=\"_blank\">Physical Layer Simplified Specification</a>. So in theory we can overclock SD card frequency to a higher value, e.g. 100 MHz. However, overclocking <a href=\"https://www.raspberrypi.org/forums/viewtopic.php?t=266682#p1620747\" rel=\"nofollow\" target=\"_blank\">only works for Raspberry Pi 3</a>.</p>\n<h3 id=\"SD-Card-Speed-Test\"><a href=\"https://www.raspberrypi.org/blog/sd-card-speed-test/\" rel=\"nofollow\" target=\"_blank\">SD Card Speed Test</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#SD-Card-Speed-Test\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Install the tool to test your SD card speed</p>\n<pre><code>sudo apt update\nsudo apt install agnostics\n</code></pre>\n<p>my SanDisk Ultra A1 128 GB SD card has the following result</p>\n<pre><code>Sequential write speed 25460 KB/sec\nRandom write speed 1077 IOPS\nRandom read speed 2642 IOPS\n</code></pre>\n<h2 id=\"Burn-the-Raspberry-Pi-OS-image-to-SD-card\">Burn the Raspberry Pi OS image to SD card<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Burn-the-Raspberry-Pi-OS-image-to-SD-card\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<ol>\n<li>Download and install <a href=\"https://www.raspberrypi.com/software/\" rel=\"nofollow\" target=\"_blank\">Raspberry Pi Imager</a>.</li>\n<li>Select device</li>\n<li>Select OS <strong>Raspberry Pi OS Lite</strong> or <strong>Raspberry Pi OS with desktop</strong> from <a href=\"https://www.raspberrypi.com/software/operating-systems/#raspberry-pi-os-64-bit\" rel=\"nofollow\" target=\"_blank\">Raspberry Pi official operating system images</a>.</li>\n<li>Select SD card. You may need <strong>SD Card Reader USB adapter</strong> if your computer doesn&#x27;t have SD card slot.</li>\n<li>Click <strong>Start</strong></li>\n</ol>\n<h2 id=\"CLI-Enviroment-Configuration\">CLI Enviroment Configuration<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#CLI-Enviroment-Configuration\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<h3 id=\"Boot-Raspberry-Pi-OS-Lite\">Boot Raspberry Pi OS Lite<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Boot-Raspberry-Pi-OS-Lite\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Plug the SD card to your Raspberry Pi and power on the device, follow the instructions to complete the basic setting. You will see the TTY when the boot process finish.</p>\n<h3 id=\"Switch-to-TTY\">Switch to TTY<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Switch-to-TTY\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>You can press Ctrl + Alt + F1/F2/F3/F4/F5/F6/F8/F10/F11/F12 to switch to different TTY console and press Ctrl + Alt + F7 you can switch to desktop environment if you have it installed.</p>\n<h3 id=\"Set-Language\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#localising-your-raspberry-pi\" rel=\"nofollow\" target=\"_blank\">Set Language</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Set-Language\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Execute <code>sudo raspi-config</code> and then select Localization Options &gt; Locale. This option will execute following <a href=\"https://github.com/RPi-Distro/raspi-config/blob/2be7313596b228c349c829ca7258cbdbd4b5deb1/raspi-config#L532\" rel=\"nofollow\" target=\"_blank\">commands</a>.</p>\n<h3 id=\"Set-Keyboard-Layout\"><a href=\"https://wiki.debian.org/Keyboard\" rel=\"nofollow\" target=\"_blank\">Set Keyboard Layout</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Set-Keyboard-Layout\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Execute <code>sudo raspi-config</code> and then select Localization Options &gt; Keyboard. This option will execute following <a href=\"https://github.com/RPi-Distro/raspi-config/blob/2be7313596b228c349c829ca7258cbdbd4b5deb1/raspi-config#L518\" rel=\"nofollow\" target=\"_blank\">commands</a>.</p>\n<p>For standard US layout you can select <code>Generic 105-key PC (intl.)</code> and then select <code>English US</code> and <code>default layout</code>. We need to <code>sudo reboot</code> to take effect.</p>\n<h3 id=\"Rotate-the-TTY-Screen\"><a href=\"https://github.com/pimoroni/hyperpixel4/issues/39#issuecomment-717248457\" rel=\"nofollow\" target=\"_blank\">Rotate the TTY Screen</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Rotate-the-TTY-Screen\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>In order to rotate the screen in TTY mode you can use following command</p>\n<pre><code>echo &lt;rotation&gt; | sudo tee -a /sys/class/graphics/fbcon/rotate &gt; /dev/null\n</code></pre>\n<p>To always rotate the screen at startup you can add following parameter to <code>/boot/cmdline.txt</code></p>\n<pre><code>fbcon=rotate:&lt;rotation&gt;\n</code></pre>\n<p>The <code>&lt;rotation&gt;</code> can be 0, 1, 2, 3 that correspond to 0-degree, 90-degree, 180-degree, 270-degree clockwise rotation.</p>\n<h3 id=\"Connect-to-Wi-Fi\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#wireless-networking-command-line\" rel=\"nofollow\" target=\"_blank\">Connect to Wi-Fi</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Connect-to-Wi-Fi\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<h4 id=\"Configure-Wi-Fi-country-code\">Configure Wi-Fi country code<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Wi-Fi-country-code\"><i class=\"fa-solid fa-link\"></i></a></h4>\n<p>In the Raspberry Pi OS, <a href=\"https://www.raspberrypi.org/documentation/computers/configuration.html#ensure-wireless-operation\" rel=\"nofollow\" target=\"_blank\">5 GHz wireless networking is disabled until a Wi-Fi country code has been configured by the user</a>.</p>\n<p>Execute <code>sudo raspi-config</code> and then select Localization Options &gt; WLAN Country. This option will execute following <a href=\"https://github.com/RPi-Distro/raspi-config/blob/2be7313596b228c349c829ca7258cbdbd4b5deb1/raspi-config#L615-L630\" rel=\"nofollow\" target=\"_blank\">commands</a>.</p>\n<h4 id=\"Find-SSID\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#getting-wireless-lan-network-details\" rel=\"nofollow\" target=\"_blank\">Find SSID</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Find-SSID\"><i class=\"fa-solid fa-link\"></i></a></h4>\n<p>If you don&#x27;t know the SSID scan the networks in the area to find the SSID you want to connect to</p>\n<pre><code>sudo iwlist wlan0 scan | greo -i ssid\n</code></pre>\n<h4 id=\"Enter-Wi-Fi-Credentials-Interactively\">Enter Wi-Fi Credentials Interactively<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Enter-Wi-Fi-Credentials-Interactively\"><i class=\"fa-solid fa-link\"></i></a></h4>\n<p>Execute <code>sudo raspi-config</code> and then select System Options &gt; Wireless LAN. This option will execute following <a href=\"https://github.com/RPi-Distro/raspi-config/blob/2be7313596b228c349c829ca7258cbdbd4b5deb1/raspi-config#L2308\" rel=\"nofollow\" target=\"_blank\">commands</a>.</p>\n<h4 id=\"Enter-Wi-Fi-Credentials-Manually\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#adding-the-network-details-to-your-raspberry-pi\" rel=\"nofollow\" target=\"_blank\">Enter Wi-Fi Credentials Manually</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Enter-Wi-Fi-Credentials-Manually\"><i class=\"fa-solid fa-link\"></i></a></h4>\n<p>Create configuration for Wi-Fi</p>\n<pre><code>wpa_passphrase &lt;ssid&gt; &lt;password&gt; | sudo tee -a /etc/wpa_supplicant/wpa_supplicant.conf\n</code></pre>\n<p>If you are connecting to a hidden network, an extra option <code>scan_ssid</code> in the <code>wpa_supplicant.conf</code> file <code>network</code> section need to be present. You should use tab instead of space when indenting. By default, <code>wpa_passphrase</code> also include the plain text version of your password, but commented out. You should delete this line for extra security. The final network section should look like</p>\n<pre><code>network={\n    ssid=&quot;&lt;your hidden SSID&gt;&quot;\n    scan_ssid=1\n    psk=&quot;&lt;your encrypted 32 byte hexadecimal PSK&gt;&quot;\n}\n</code></pre>\n<p>and ensure the following lines are at the top of <code>wpa_supplicant</code> file, you need to double check the country is correct.</p>\n<pre><code>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\ncountry=&lt;2 letter ISO 3166-1 country code&gt;\n</code></pre>\n<p>then reconfigure the interface with</p>\n<pre><code>wpa_supplicant -c /etc/wpa_supplicant/wpa_supplicant.conf -i wlan0 -d\n</code></pre>\n<h4 id=\"Verify-the-network\">Verify the network<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Verify-the-network\"><i class=\"fa-solid fa-link\"></i></a></h4>\n<p>You can verify the connection by running following command</p>\n<pre><code>ping 8.8.8.8\n</code></pre>\n<p>If you find the network is unavailable, try to wait 2 minutes or reboot, them verify with <code>ping</code> again.</p>\n<h2 id=\"Configure-Static-IP-Address\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#static-ip-addresses\" rel=\"nofollow\" target=\"_blank\">Configure Static IP Address</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Static-IP-Address\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>If you want a static IP address, so each time you restart your Raspberry Pi device or disconnect and reconnect to the network you can find your device with same IP address. You need to add the following lines to <code>/etc/dhcpcd.conf</code>.</p>\n<pre><code>interface &lt;your-interface-name&gt;\nstatic ip_address=192.168.0.10/24\nstatic routers=192.168.0.1\nstatic domain_name_servers=192.168.0.1 8.8.8.8\n</code></pre>\n<p>You can find your interface name with <code>ip link</code>, router IP address with <code>ip route show default</code>. You need to ensure the static IP address is outside of DHCP dynamically assigned IP address range, you can verify this information in your router. You can verify your IP address with <code>ip -a address</code>.</p>\n<h2 id=\"Setting-up-SSH-Server\"><a href=\"https://www.raspberrypi.com/documentation/computers/remote-access.html#ssh\" rel=\"nofollow\" target=\"_blank\">Setting up SSH Server</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Setting-up-SSH-Server\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<h3 id=\"Enable-SSH-Server\"><a href=\"https://www.raspberrypi.com/documentation/computers/remote-access.html#enabling-the-server\" rel=\"nofollow\" target=\"_blank\">Enable SSH Server</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Enable-SSH-Server\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Enter <code>sudo raspi-config</code> in a terminal window. Select <code>Interfacing Options</code> and then <code>SSH</code>. This option will execute following <a href=\"https://github.com/RPi-Distro/raspi-config/blob/2be7313596b228c349c829ca7258cbdbd4b5deb1/raspi-config#L841\" rel=\"nofollow\" target=\"_blank\">commands</a></p>\n<h3 id=\"Configure-Passwordless-SSH-Access\"><a href=\"https://www.raspberrypi.com/documentation/computers/remote-access.html#passwordless-ssh-access\" rel=\"nofollow\" target=\"_blank\">Configure Passwordless SSH Access</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Passwordless-SSH-Access\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Generate new SSH keys using the <code>ssh-keygen</code> command on the client. Copy your public key to your Raspberry Pi. <code>cat ~/.ssh/id_rsa.pub | ssh &lt;USERNAME&gt;@&lt;IP-ADDRESS&gt; &#x27;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&#x27;</code>.</p>\n<h3 id=\"Disable-Password-Authentication\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#using-key-based-authentication\" rel=\"nofollow\" target=\"_blank\">Disable Password Authentication</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Disable-Password-Authentication\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Edit <code>/etc/ssh/sshd_config</code> and change these options to <code>no</code></p>\n<pre><code>ChallengeResponseAuthentication no\nPasswordAuthentication no\nUsePAM no\n</code></pre>\n<h3 id=\"Change-SSH-Server-Port\">Change SSH Server Port<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Change-SSH-Server-Port\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>By default, SSH server listen to <code>22</code>. Edit <code>/etc/ssh/sshd_config</code> and change <code>Port</code> to other value e.g. <code>2222</code></p>\n<h3 id=\"Disable-IPv6-SSH-Access\">Disable IPv6 SSH Access<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Disable-IPv6-SSH-Access\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Edit <code>/etc/ssh/sshd_config</code> and change <code>AddressFamily</code> to <code>inet</code> which means IPv4 only.</p>\n<h3 id=\"Listen-To-Local-Network-Only\">Listen To Local Network Only<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Listen-To-Local-Network-Only\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Edit <code>/etc/ssh/sshd_config</code> and change <code>ListenAddress</code> to private network static address that you have configured before. When you specify IP address explicitly in sshd config file, <a href=\"https://unix.stackexchange.com/a/499712\" rel=\"nofollow\" target=\"_blank\">network interfaces must be prepared prior to sshd start</a>. Execute <code>sudo systemctl edit sshd</code> and add following content.</p>\n<pre><code>[Unit]\nAfter=network-pre.target network.target network-online.target auditd.service dhcpcd.service\n\n[Service]\nRestart=on-failure\nRestartSec=5\nRestartPreventExitStatus=\n</code></pre>\n<p>Then execute <code>sudo systemctl enable systemd-networkd-wait-online</code>.</p>\n<h3 id=\"Apply-Latest-SSH-Configuration\">Apply Latest SSH Configuration<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Apply-Latest-SSH-Configuration\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Restart the ssh system with <code>sudo service ssh reload</code>.</p>\n<h2 id=\"Firewall-Configuration\"><a href=\"https://www.raspberrypi.com/documentation/computers/configuration.html#install-a-firewall\" rel=\"nofollow\" target=\"_blank\">Firewall Configuration</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Firewall-Configuration\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<pre><code>sudo apt install ufw\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\nsudo ufw allow in on eth0 from 192.168.0.0/24 to 192.168.0.10 port 2222 proto tcp\nsudo ufw enable\nsudo ufw status numbered verbose\n</code></pre>\n<h2 id=\"Disable-Wi-Fi--Bluetooth\">Disable Wi-Fi &amp; Bluetooth<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Disable-Wi-Fi--Bluetooth\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>Add these 2 lines to <code>/boot/config.txt</code></p>\n<pre><code>dtoverlay=disable-wifi\ndtoverlay=disable-bt\n</code></pre>\n<p>Here you can find the documentations of <a href=\"https://github.com/raspberrypi/firmware/blob/afc7631bc9a58f94a157503955881ab27a6287d0/boot/overlays/README#L736-L739\" rel=\"nofollow\" target=\"_blank\"><code>disable-wifi</code></a> and <a href=\"https://github.com/raspberrypi/firmware/blob/afc7631bc9a58f94a157503955881ab27a6287d0/boot/overlays/README#L727-L733\" rel=\"nofollow\" target=\"_blank\"><code>disable-bt</code></a>.</p>\n<h2 id=\"Configure-Fan\">Configure Fan<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Fan\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>When you buy a Raspberry Pi 4B you can also optionally buy a case with fan e.g. the official <a href=\"https://www.raspberrypi.org/products/raspberry-pi-4-case-fan/\" rel=\"nofollow\" target=\"_blank\">Raspberry Pi 4 Case Fan</a>. You can simply connect the fan wires to 5V and ground pin but Raspberry Pi support advance fan control base on temperature. Run <code>sudo raspi-config</code>, select <code>Performance Options</code> then select <code>Fan</code>, introduce the GPIO that will be enabled when temperature exceeds the limit you introduced. You need to reboot after the configuration change. Run the command <a href=\"https://www.raspberrypi.org/documentation/computers/os.html#gpio-pinout\" rel=\"nofollow\" target=\"_blank\"><code>pinout</code></a> to find the location of GPIO and connect it to base gate of a transistor, connect negative wire of fan to ground. If you are using NPN transistor then connect emitter gate to positive wire of fan and 5V to collector gate of transistor. If you are using PNP transistor then connect collector gate to positive wire of fan and 5V to emitter gate of transistor. You can use protoboard to arrange the wires. You can verify current temperature using command <code>vcgencmd measure_temp</code>. For testing the fan control based on temperature, you can run a stress test to increase the temperature with <code>stress --cpu 4 --timeout 60</code>.</p>\n<h2 id=\"NAS-with-Samba-and-External-Disk-through-USB-30\"><a href=\"https://www.raspberrypi.com/documentation/computers/remote-access.html#samba-smbcifs\" rel=\"nofollow\" target=\"_blank\">NAS with Samba and External Disk through USB 3.0</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#NAS-with-Samba-and-External-Disk-through-USB-30\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<h3 id=\"Mount-External-Disk\">Mount External Disk<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Mount-External-Disk\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Attach the external disk to the USB 3.0 port and run following to ensure the device is recognized</p>\n<pre><code>sudo blkid\nsudo fdisk -l\n</code></pre>\n<p>If your disk is <code>NTFS</code> file system then we need to install following package</p>\n<pre><code>sudo apt install ntfs-3g\n</code></pre>\n<p>Once you know where the drive is located, run following command, the type argument might be different depending on your drive file system</p>\n<pre><code>sudo mkdir -p /mnt/shared\nsudo mount -t ntfs-3g /dev/&lt;what you have found in previous step e.g. sda1&gt; /mnt/shared\n</code></pre>\n<p>To permanently mount at startup, add the following line to <code>/etc/fstab</code></p>\n<pre><code>/dev/&lt;what you have found in previous step e.g. sda1&gt;    /mnt/shared   ntfs    default  0  0\n</code></pre>\n<h3 id=\"Setup-Shared-Folder-on-Raspberry\">Setup Shared Folder on Raspberry<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Setup-Shared-Folder-on-Raspberry\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Installing Samba Support with following commands</p>\n<pre><code>sudo apt update\nsudo apt install samba samba-common-bin cifs-utils\n</code></pre>\n<p>Sharing a folder is easy</p>\n<pre><code>sudo useradd -M -s /sbin/nologin samba\nsudo passwd samba\nsudo chmod 700 /mnt/shared\nsudo chown samba /mnt/shared\nsudo smbpasswd -a samba\n</code></pre>\n<p>Edit the Samba configuration file <code>/etc/samba/smb.conf</code> and add the following lines</p>\n<pre><code>[shared]\n    path = /mnt/shared\n    read only = no\n    guest ok = no\n    security = user\n    valid users = samba\n    writable = yes\n    vfs objects = recycle\n    recycle:repository = .recycle/%U\n    recycle:touch = yes\n    recycle:keeptree = yes\n    recycle:versions = yes\n</code></pre>\n<p>In the same file change these two properties to</p>\n<pre><code>interfaces = 192.168.0.10/24 eth0\nworkgroup = &lt;your workgroup name here - you find it in Windows client machine System Properties - Computer Name&gt;\n</code></pre>\n<p>Apply the change</p>\n<pre><code>sudo service smbd reload\n</code></pre>\n<p>Allow the Samba traffic through firewall</p>\n<pre><code>sudo ufw allow in on eth0 from 192.168.0.0/24 to 192.168.0.10 app Samba\n</code></pre>\n<h3 id=\"Mount-Samba-Shared-Folder\">Mount Samba Shared Folder<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Mount-Samba-Shared-Folder\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>net use Z: \\\\192.168.0.10\\shared /SAVECRED /PERSISTENT:YES\n</code></pre>\n<p>It will ask for username and password, you should introduce <code>samba</code> as username.</p>\n<h3 id=\"Remove-Samba-Shared-Folder\">Remove Samba Shared Folder<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Remove-Samba-Shared-Folder\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>net use  Z: /delete\n</code></pre>\n<h2 id=\"NAS-Backup-with-Dropbox-and-Rclone\"><a href=\"https://rclone.org/dropbox/\" rel=\"nofollow\" target=\"_blank\">NAS Backup with Dropbox and Rclone</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#NAS-Backup-with-Dropbox-and-Rclone\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<h3 id=\"Get-your-own-Dropbox-App-ID\"><a href=\"https://rclone.org/dropbox/#get-your-own-dropbox-app-id\" rel=\"nofollow\" target=\"_blank\">Get your own Dropbox App ID</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Get-your-own-Dropbox-App-ID\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<h3 id=\"Install-Rclone\">Install Rclone<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Install-Rclone\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>sudo apt update\nsudo apt install rclone\n</code></pre>\n<h3 id=\"Configure-Rclone\">Configure Rclone<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Rclone\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>rclone config\n</code></pre>\n<p>Follow the instructions until you need to visit an URL, you will need to use SSH local forward</p>\n<pre><code>sudo ufw default allow FORWARD\nsudo service ufw restart\nssh -p 2222 -N -L 127.0.0.1:53682:127.0.0.1:53682 sgao@192.168.0.10\n</code></pre>\n<p>Open the link that is mentioned in following <a href=\"https://github.com/rclone/rclone/issues/4792#issuecomment-731758924\" rel=\"nofollow\" target=\"_blank\">workaround</a> to avoid expiration issue. You can verify that refresh token is present</p>\n<pre><code>cat ~/.config/rclone/rclone.conf\n</code></pre>\n<p>Rollback the <code>ufw</code> configuration</p>\n<pre><code>sudo ufw default deny FORWARD\nsudo service ufw restart\n</code></pre>\n<h3 id=\"Backup-with-Dropbox\"><a href=\"https://rclone.org/commands/rclone_sync/\" rel=\"nofollow\" target=\"_blank\">Backup with Dropbox</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Backup-with-Dropbox\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>We first verify the setup is correct</p>\n<pre><code>rclone lsd dropbox:\n</code></pre>\n<p>Then sync from Dropbox to a local folder</p>\n<pre><code>mkdir -p /mnt/shared/Dropbox\nrclone copy dropbox: /mnt/shared/Dropbox\n</code></pre>\n<p>Finally, keep the folder synchronized with Dropbox</p>\n<pre><code>rclone sync /mnt/shared/Dropbox dropbox:\n</code></pre>\n<h3 id=\"Keep-Dropbox-Synced-With-Local\">Keep Dropbox Synced With Local<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Keep-Dropbox-Synced-With-Local\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Install the <code>inotify-tools</code></p>\n<pre><code>sudo apt update\nsudo apt install inotify-tools\n</code></pre>\n<p>Save following commands to <code>~/dropbox-sync-from-local-to-remote.sh</code></p>\n<pre><code>#!/bin/bash\n# Execute first time after the machine is boot\nrclone sync /mnt/shared/Dropbox dropbox:\ninotifywait -m -q -r -e create -e modify -e move -e delete --format &#x27;%w%f:%e&#x27; /mnt/shared/Dropbox | \\\nwhile read; do \\\n    path=$(echo $REPLY | cut -d &quot;:&quot; -f 1); \\\n    event=$(echo $REPLY | cut -d &quot;:&quot; -f 2); \\\n    echo &quot;$path was changed because of event $event&quot;; \\\n    echo &quot;Skipping $(timeout 3 cat | wc -l) further changes&quot;; \\\n    rclone sync --delete-during /mnt/shared/Dropbox dropbox:; \\\ndone\n</code></pre>\n<p>We need to add execute permission to the script file</p>\n<pre><code>chmod +x ~/dropbox-sync-from-local-to-remote.sh\n</code></pre>\n<p>Create a <code>Cron</code> job at boot time by executing <code>crontab -e</code> and then add following line to the task list</p>\n<pre><code>@reboot sleep 10 &amp;&amp; ~/dropbox-sync-from-local-to-remote.sh &gt;&gt; ~/dropbox-sync-from-local-to-remote.log 2&gt;&amp;1\n</code></pre>\n<h3 id=\"Keep-Local-Synced-With-Dropbox\">Keep Local Synced With Dropbox<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Keep-Local-Synced-With-Dropbox\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Save following commands to <code>~/dropbox-sync-from-remote-to-local.sh</code></p>\n<pre><code>rclone sync dropbox: /mnt/shared/Dropbox --backup-dir /mnt/shared/Dropbox-Backup --suffix .$(date +&quot;%Y-%m-%d-%H-%M-%S&quot;)\n</code></pre>\n<p>Create a <code>Cron</code> job by executing <code>crontab -e</code> and then add following line to the task list</p>\n<pre><code>*/5 * * * * ~/dropbox-sync-from-remote-to-local.sh &gt;&gt; ~/dropbox-sync-from-remote-to-local.log 2&gt;&amp;1\n</code></pre>\n<h2 id=\"Upgrade-Raspberry-Pi-OS\"><a href=\"https://www.raspberrypi.org/documentation/computers/os.html#upgrading-from-operating-system-versions\" rel=\"nofollow\" target=\"_blank\">Upgrade Raspberry Pi OS</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Upgrade-Raspberry-Pi-OS\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>Modify the file <code>/etc/apt/sources.list</code> and <code>/etc/apt/sources.list.d/raspi.list</code> and replace every occurrence of the word <code>buster</code> to <code>bullseye</code>.</p>\n<pre><code>sudo apt update\nsudo apt -y dist-upgrade\nsudo reboot\n</code></pre>\n<h3 id=\"Remove-Unused-Software-After-Upgrade\">Remove Unused Software After Upgrade<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Remove-Unused-Software-After-Upgrade\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>sudo apt purge geany thonny\nsudo apt autoremove\n</code></pre>\n<h2 id=\"Desktop-Environment-Configuration\">Desktop Environment Configuration<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Desktop-Environment-Configuration\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<p>Raspberry Pi OS provides desktop environment, and we can also upgrade from lite version to desktop version, but it is recommended that if you need to use desktop environment, download the desktop version directly.</p>\n<h3 id=\"Install-Desktop-Environment-from-Lite-Version\"><a href=\"https://gist.github.com/kmpm/8e535a12a45a32f6d36cf26c7c6cef51\" rel=\"nofollow\" target=\"_blank\">Install Desktop Environment from Lite Version</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Install-Desktop-Environment-from-Lite-Version\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<pre><code>sudo apt install -y lightdm raspberrypi-ui-mods rpi-chromium-mods\nsudo apt install -y arandr # https://www.raspberrypi.org/forums/viewtopic.php?t=265472#p1613632\nsudo apt install --no-install-recommends xinit\n</code></pre>\n<p>After the installation you can enter the desktop environment using <code>startx</code> from TTY console.</p>\n<h3 id=\"Boot-Raspberry-Pi-OS-with-desktop\">Boot Raspberry Pi OS with desktop<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Boot-Raspberry-Pi-OS-with-desktop\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>If you boot with a desktop image, you will see a GUI windows that guide you through the initial setup, e.g. configuring the country, language, keyboard, Wi-Fi.</p>\n<h3 id=\"Configure-Display-Setting\"><a href=\"https://www.raspberrypi.org/documentation/computers/configuration.html#hdmi-configuration\" rel=\"nofollow\" target=\"_blank\">Configure Display Setting</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Configure-Display-Setting\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>Edit <code>/boot/config.txt</code> and ensure following parameters has the following values:</p>\n<pre><code>hdmi_drive=2 # https://www.raspberrypi.org/documentation/computers/configuration.html#troubleshooting-your-hdmi-2\nhdmi_group=2 # https://www.raspberrypi.org/documentation/computers/config_txt.html#hdmi_group\nhdmi_mode=82 # https://www.raspberrypi.org/documentation/computers/config_txt.html#hdmi_mode\n</code></pre>\n<h3 id=\"Rotate-your-Display-in-GUI\"><a href=\"https://www.raspberrypi.org/documentation/computers/configuration.html#rotating-your-display\" rel=\"nofollow\" target=\"_blank\">Rotate your Display in GUI</a><a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Rotate-your-Display-in-GUI\"><i class=\"fa-solid fa-link\"></i></a></h3>\n<p>You can check you available display with:</p>\n<pre><code>xrandr -q\n</code></pre>\n<p>Then use the name of display you get previously to rotate the screen</p>\n<pre><code>xrandr --output [name of display e.g. HDMI-1] --rotate left\n</code></pre>\n<h2 id=\"Reference\">Reference<a aria-hidden=\"true\" tabindex=\"-1\" href=\"#Reference\"><i class=\"fa-solid fa-link\"></i></a></h2>\n<ul>\n<li><a href=\"https://github.com/RPi-Distro/raspi-config/blob/master/raspi-config\" rel=\"nofollow\" target=\"_blank\">raspi-config</a></li>\n<li><a href=\"https://wiki.samba.org/index.php/Setting_up_Samba_as_a_Standalone_Server\" rel=\"nofollow\" target=\"_blank\">Samba Wiki: Setting up Samba as a Standalone Server</a></li>\n<li><a href=\"https://unix.stackexchange.com/a/112066\" rel=\"nofollow\" target=\"_blank\">How can I have a Trash/Recycle Bin for my Samba shares?</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/gg651155(v=ws.11)\" rel=\"nofollow\" target=\"_blank\">Command-Line Reference: Net use</a></li>\n<li><a href=\"https://lonewolfonline.net/enabling-recycle-bin-functionality-samba/\" rel=\"nofollow\" target=\"_blank\">Enabling Recycle Bin like functionality in Samba</a></li>\n<li><a href=\"https://www.samba.org/samba/docs/current/man-html/vfs_recycle.8.html\" rel=\"nofollow\" target=\"_blank\">Samba VFS recycle bin</a></li>\n<li><a href=\"https://www.ralphminderhoud.com/blog/rclone-two-way-dropbox-sync/\" rel=\"nofollow\" target=\"_blank\">Rclone: Simple two-way dropbox sync</a></li>\n</ul>"
    },
    "lang": "en",
    "_nextI18Next": {
      "initialI18nStore": {
        "en": {
          "navbar": {
            "Home": "Home",
            "Language": "Language",
            "Tags": "Tags",
            "en": "English",
            "es": "Spanish",
            "zh": "Chinese"
          },
          "post-layout": { "Author": "Author: {{author}}", "Tags": "Tags" }
        }
      },
      "initialLocale": "en",
      "ns": ["navbar", "post-layout"],
      "userConfig": {
        "i18n": { "defaultLocale": "en", "locales": ["en", "es", "zh"] },
        "default": {
          "i18n": { "defaultLocale": "en", "locales": ["en", "es", "zh"] }
        }
      }
    }
  },
  "__N_SSG": true
}
